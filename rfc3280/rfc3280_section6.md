## 6. Certification Path Validation   

인터넷 PKI에 대한 인증 경로 검증 절차는 [X.509]에서 제공한 알고리즘에 기초한다. 인증 경로 처리는 주체 식별 이름 및/또는 주체 대체 이름과 주체 공개 키 간의 바인딩을 확인한다. 바인딩은 경로를 구성하는 인증서에 지정된 제약 조건과 종속 당사자가 지정한 입력에 의해 제한된다. 기본 제약 조건 및 정책 제약 조건 확장은 인증 경로 처리 논리를 통한 의사 결정 프로세스 자동화를 가능하게 한다. 

이 section에서는 인증 경로를 검증하는 알고리즘을 설명한다. 이 사양의 구현은 이 알고리즘을 구현하지 않아도 되지만, 이 절차로 인해 발생하는 외부 동작과 동일한 기능을 제공해야 한다. 올바른 결과를 도출하는 모든 알고리즘은 특정 구현에서 사용할 수 있다. 

Section 6.1에서는 기본 경로 검증을 설명한다. 유효한 경로는 신뢰가능한 앵커가 발급하는 인증서로 시작한다. 이 알고리즘은 CA의 공개키, 이름 및 이 키를 사용하여 검증될 수 있는 경로 집합에 대한 제약조건을 필요로 한다.

신뢰가능한 앵커의 선택은 정책의 고려사항이다: PKI계층의 최상위 CA; 검증자의 자체 인증서를 발급한 CA; 또는 PKI 네트워크의 또 다른 CA가 될 수 있다. 경로 검증 절차는 신뢰가능한 앵커의 선택과 무관하게 동일하다. 또한 서로 다른 응용프로그램은 다른 신뢰 앵커에 의존하거나 서로 다른 신뢰 앵커 집합으로 시작하는 경로를 허용할 수 있다.

Section 6.2에서는 특정 구현에서 경로 유효성 검사 알고리즘을 사용하는 방법을 설명한다. 두 가지 구체적인 방법이 의논된다: 여러 신뢰할 수 있는 CA 중 하나로 경로가 시작할 수 있는 경우; PEM 아키텍처와의 호환성이 필요한 경우.

Section 6.3에서는 CRL이 인증서 발급자가 사용하는 해지 메커니즘인 경우 인증서가 해지되었는지 또는 보류 상태인지 결정하는 데 필요한 단계를 설명한다.

### 6.1. Basic Path Validation    

이 문서에서는 X.509 경로 처리 알고리즘에 대해 설명한다. 적합한  구현에는 이 알고리즘의 외부 동작과 기능적으로 동일한 X.509 경로 처리 절차가 포함되어야 한다. 그러나 이 알고리즘에서 처리되는 인증서 확장에 대한 지원은 호환 구현의 경우 선택 사항이다.  클라이언트는 지원하지 않는 확장에 대해 경로 유효성 검사 알고리즘에서 해당 단계를 생략할 수 있다. 예를 들면, 클라이언트는 정책 매핑 확장을 지원할 필요가 없다. 이 확장을 지원하지 않는 클라이언트는 정책 매핑이 처리되는 경로 유효성 검사 단계를 생략할 수 있다. 기억해야 할 점은, 지원되지 않는 중요한 확장이 포함된 경우 클라이언트는 인증서를 거부해야 한다는 것이다.

이 섹션에 제시된 알고리즘은 현재 날짜 및 시간에 대해 인증서를 검증한다. 이 명세에 적합한 구현은 과거의 어느 지점에 대한 유효성 검사 또한 지원할 수 있다. 인증서 유효 기간을 벗어난 시간에 대해서는 인증서를 검증하는 메커니즘을 사용할 수 없다.

신뢰가능한 앵커는 알고리즘의 입력값(input)이다. 모든 인증 경로의 유효성을 확인하는 데 동일한 신뢰 앵커를 사용할 필요는 없다. 섹션 6.2에서 자세히 설명한 바와 같이, 서로 다른 경로를 검증하기 위해 서로 다른 신뢰 앵커를 사용할 수 있다.

경로 검증의 주요한 목표는 <b>신뢰가능한 앵커(노드)의 공개 키를 기반으로 end entity 인증서에 표시된 것처럼 주체 고유 이름(subject distinguished name) 또는 주체 대체 이름(subject alternative name)과 주체 공개 키 간의 바인딩을 확인</b>하는 것이다. 이 작업을 수행하려면 해당 바인딩을 지원하는 일련의 인증서를 받아야 한다. 이 인증서 시퀀스를 얻기 위해 수행되는 절차는 이 규격의 범위를 벗어납니다.

이 목표를 달성하기 위해 경로 검증 프로세스는 예상 인증 경로 (n 개의 인증서 시퀀스)가 다음 조건을 충족하는지 확인한다:   
1. { 1, 2, ..., n-1 }의 모든 원소 x에 대해, 인증서 x의 주체가 인증서 x+1의 발행자
2. 인증서1은 신뢰가능한 앵커(root)에 의해 발행됨
3. 인증서n은 검증할 인증서
4. { 1, 2, ..., n }의 모든 원소 x에 대해, 인증서는 문제의 시간에 유효

신뢰가능한 앵커가 자체 서명 인증서의 형태로 제공되는 경우, 이 자체 서명 인증서는 예상 인증 경로의 일부로 포함되지 않는다. 신뢰 가능한 앵커에 대한 정보는 인증 경로 검증 알고리즘의 입력값으로 제공된다(section 6.1.1). `→trust anchor(RootCA)는 인증서를 자체 발급한다. 따라서 RootCA의 자체 발급 형태 인증서는 검증 대상에서 제외된다.`

그러나 특정 인증 경로가 모든 애플리케이션에 적합하지 않을 수 있다. 따라서 응용프로그램은 이 알고리즘을 확장하여 유효한 경로 집합을 추가로 제한할 수 있다. 또한 경로 유효성 검사 절차는 인증서 정책 확장, 정책 매핑 확장, 정책 제약 조건 확장 및 금지 정책 확장에 따라 이 경로에 유효한 인증서 정책 집합을 결정한다. 이를 위해 `경로 유효성 검사 알고리즘은 유효한 정책 트리를 구성`한다. 이 경로에 유효한 인증서 정책 집합이 비어 있지 않으면 n개의 유효한 정책 트리가 되고, 그렇지 않으면 유효한 정책 트리는 null이 된다.

주체 및 발급자 필드에 나타나는 DN이 동일하고 비어 있지 않으면 인증서가 자체 발급된 것이다. 일반적으로 경로를 구성하는 인증서의 발급자와 주체는 인증서마다 다르다. 그러나 CA는 인증서 정책의 주요 롤오버 또는 변경을 지원하기 위해 자체적으로 인증서를 발급할 수 있다. 자체 발급 인증서는 경로 길이 또는 이름 제약 조건을 평가할 때 계산되지 않는다.

본 section은 알고리즘을 네 개의 기본 단계로 나타낸다:
1. 초기화(initialization)
2. 기본 인증서 처리
3. 다음 인증서 준비 
4. 마무리   

위 절차 중 (1)과 (4)는 정확하게 한번 수행된다. 절차(2)는 경로 내 모든 인증서에서 수행된다. 절차(3)은 절차 내 최종 마지막 인증서를 제외한 모든 인증서에서 수행된다. 